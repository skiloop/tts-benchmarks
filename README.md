# TTS Benchmarks

TTSï¼ˆText-to-Speechï¼‰é¡¹ç›®æ€§èƒ½æµ‹è¯„å·¥å…·é›†ã€‚

## âœ¨ ç‰¹æ€§

- ğŸ¯ **chartts**: ChatTTS å‘½ä»¤è¡Œå®¢æˆ·ç«¯ - ç®€å•æ˜“ç”¨çš„å‘½ä»¤è¡Œæ¥å£
- âš¡ **perftest**: æ€§èƒ½æµ‹è¯•å·¥å…· - å‡†ç¡®æ¯”è¾ƒä¸åŒTTSå¼•æ“çš„æ€§èƒ½
- ğŸ“Š æ”¯æŒæ‰¹é‡å¤„ç†å’Œè‡ªåŠ¨åŒ–æµ‹è¯•
- ğŸ”§ ä¸°å¯Œçš„é…ç½®é€‰é¡¹å’Œå‚æ•°è°ƒæ•´
- ğŸ“ˆ è¯¦ç»†çš„æ€§èƒ½ç»Ÿè®¡å’ŒJSONè¾“å‡º
- ğŸš€ æ”¯æŒCPU/GPU/MPSç­‰å¤šç§è®¾å¤‡

## å¿«é€Ÿå¼€å§‹

```bash
# 1. å®‰è£…ä¾èµ–
pip install -r requirements.txt

# 2. å®‰è£…å‘½ä»¤è¡Œå·¥å…·
./install.sh

# 3. ç”Ÿæˆç¬¬ä¸€ä¸ªè¯­éŸ³
chartts -t "ä½ å¥½ä¸–ç•Œ" -o hello.wav

# 4. è¿è¡Œæµ‹è¯•
./test_chartts.sh
```

æ›´å¤šä¿¡æ¯è¯·æŸ¥çœ‹ï¼š
- ğŸ“– [å®‰è£…è¯´æ˜](INSTALL.md) - è¯¦ç»†çš„å®‰è£…æ­¥éª¤å’Œæ•…éšœæ’é™¤
- ğŸš€ [å¿«é€Ÿå…¥é—¨](QUICKSTART.md) - 5åˆ†é’Ÿä¸Šæ‰‹æŒ‡å—
- ğŸ“ [ç¤ºä¾‹è„šæœ¬](examples/) - å®ç”¨ç¤ºä¾‹é›†åˆ

## å®‰è£…

### 1. å…‹éš†ä»“åº“

```bash
git clone <repository-url>
cd tts-benchmarks
```

### 2. å®‰è£…ä¾èµ–

```bash
pip install -r requirements.txt
```

### 3. å®‰è£…å‘½ä»¤è¡Œå·¥å…·

```bash
./install.sh
```

è¿™ä¼šå°†æ‰€æœ‰è„šæœ¬é“¾æ¥åˆ° `~/.local/bin/` ç›®å½•ï¼ˆç¡®ä¿è¯¥ç›®å½•åœ¨ä½ çš„ PATH ä¸­ï¼‰ã€‚

ä½ ä¹Ÿå¯ä»¥è‡ªå®šä¹‰å®‰è£…è·¯å¾„ï¼š

```bash
DST_PATH=/usr/local/bin ./install.sh
```

## ä½¿ç”¨è¯´æ˜

### ChatTTS å‘½ä»¤è¡Œå®¢æˆ·ç«¯

`chartts` æä¾›äº† ChatTTS çš„å‘½ä»¤è¡Œæ¥å£ï¼Œæ–¹ä¾¿æµ‹è¯„å’Œæ‰¹é‡å¤„ç†ã€‚

#### åŸºæœ¬ç”¨æ³•

```bash
# ç›´æ¥è¾“å…¥æ–‡æœ¬
chartts -t "ä½ å¥½ä¸–ç•Œ" -o output.wav

# ä»æ–‡ä»¶è¯»å–æ–‡æœ¬
chartts -f input.txt -o output.wav

# æŒ‡å®šè¯´è¯äººï¼ˆæ§åˆ¶éŸ³è‰²ï¼‰
chartts -t "æµ‹è¯•è¯­éŸ³" -o test.wav --speaker 123

# è°ƒæ•´ç”Ÿæˆå‚æ•°
chartts -t "æµ‹è¯•è¯­éŸ³" -o test.wav --temperature 0.3 --top-p 0.7

# ä½¿ç”¨æ–‡æœ¬ä¼˜åŒ–æé«˜è´¨é‡
chartts -t "é«˜è´¨é‡è¯­éŸ³" -o high_quality.wav --refine

# è¯¦ç»†è¾“å‡º
chartts -t "æµ‹è¯•" -o test.wav -v
```

#### å‚æ•°è¯´æ˜

**è¾“å…¥å‚æ•°ï¼š**
- `-t, --text TEXT`: è¦è½¬æ¢çš„æ–‡æœ¬
- `-f, --file FILE`: åŒ…å«æ–‡æœ¬çš„è¾“å…¥æ–‡ä»¶

**è¾“å‡ºå‚æ•°ï¼š**
- `-o, --output FILE`: è¾“å‡ºéŸ³é¢‘æ–‡ä»¶è·¯å¾„ï¼ˆWAVæ ¼å¼ï¼‰

**ChatTTS å‚æ•°ï¼š**
- `--speaker SEED`: è¯´è¯äººç§å­ï¼Œç”¨äºæ§åˆ¶éŸ³è‰²ï¼ˆæ•´æ•°ï¼‰
- `--temperature FLOAT`: æ¸©åº¦å‚æ•°ï¼Œæ§åˆ¶ç”Ÿæˆçš„éšæœºæ€§ï¼ˆé»˜è®¤: 0.3ï¼‰
- `--top-p FLOAT`: Top-Pé‡‡æ ·å‚æ•°ï¼ˆé»˜è®¤: 0.7ï¼‰
- `--top-k INT`: Top-Ké‡‡æ ·å‚æ•°ï¼ˆé»˜è®¤: 20ï¼‰
- `--refine`: ä½¿ç”¨refineæ–‡æœ¬ä»¥æé«˜è´¨é‡
- `--sample-rate INT`: é‡‡æ ·ç‡ï¼ˆé»˜è®¤: 24000ï¼‰

**è®¾å¤‡å‚æ•°ï¼š**
- `--device {auto,cpu,cuda,mps}`: ä½¿ç”¨çš„è®¾å¤‡ï¼ˆé»˜è®¤: autoï¼‰
- `--compile`: ä½¿ç”¨torch.compileåŠ é€Ÿï¼ˆéœ€è¦PyTorch 2.0+ï¼‰

**å…¶ä»–å‚æ•°ï¼š**
- `-v, --verbose`: æ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯

### æ€§èƒ½æµ‹è¯•å·¥å…·

`perftest` ç”¨äºæµ‹è¯•å’Œæ¯”è¾ƒå¤šä¸ªå‘½ä»¤çš„æ€§èƒ½ã€‚

#### åŸºæœ¬ç”¨æ³•

```bash
# æµ‹è¯•ä¸¤ä¸ªå‘½ä»¤
perftest -c "sleep 1" -c "sleep 0.5" -n 3

# ä½¿ç”¨é…ç½®æ–‡ä»¶
perftest -f config.json

# åˆ›å»ºç¤ºä¾‹é…ç½®æ–‡ä»¶
perftest --sample-config perftest.json

# æŒ‡å®šå‘½ä»¤åç§°
perftest -t "slow,sleep 1" -t "fast,sleep 0.5" -n 5 -v

# ä¿å­˜ç»“æœ
perftest -f config.json -o results.json
```

#### TTS æ€§èƒ½æµ‹è¯„ç¤ºä¾‹

åˆ›å»ºä¸€ä¸ªé…ç½®æ–‡ä»¶ `tts-benchmark.json`:

```json
{
  "description": "TTSå¼•æ“æ€§èƒ½æµ‹è¯„",
  "iterations": 5,
  "tests": [
    {
      "name": "ChatTTS",
      "command": "chartts -t 'è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•æ–‡æœ¬' -o /tmp/chattts_test.wav"
    },
    {
      "name": "å…¶ä»–TTSå·¥å…·",
      "command": "other-tts -t 'è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•æ–‡æœ¬' -o /tmp/other_test.wav"
    }
  ]
}
```

è¿è¡Œæµ‹è¯„ï¼š

```bash
perftest -f tts-benchmark.json -o results.json
```

#### å‚æ•°è¯´æ˜

**è¾“å…¥å‚æ•°ï¼š**
- `-c, --command CMD`: è¦æµ‹è¯•çš„å‘½ä»¤ï¼ˆå¯å¤šæ¬¡æŒ‡å®šï¼‰
- `-t, --test "NAME,CMD"`: å‘½åæµ‹è¯•ï¼Œæ ¼å¼: "åç§°,å‘½ä»¤"ï¼ˆå¯å¤šæ¬¡æŒ‡å®šï¼‰
- `-f, --config FILE`: ä» JSON é…ç½®æ–‡ä»¶åŠ è½½æµ‹è¯•

**è¿è¡Œå‚æ•°ï¼š**
- `-n, --iterations N`: æ¯ä¸ªå‘½ä»¤è¿è¡Œçš„æ¬¡æ•°ï¼ˆé»˜è®¤: 3ï¼‰
- `-v, --verbose`: è¯¦ç»†è¾“å‡ºæ¯æ¬¡è¿è¡Œçš„ç»“æœ
- `--debug`: è°ƒè¯•æ¨¡å¼ï¼Œæ˜¾ç¤º time å‘½ä»¤çš„åŸå§‹è¾“å‡º

**è¾“å‡ºå‚æ•°ï¼š**
- `-o, --output FILE`: ä¿å­˜ç»“æœåˆ° JSON æ–‡ä»¶
- `--no-color`: ç¦ç”¨å½©è‰²è¾“å‡º

**å…¶ä»–å‚æ•°ï¼š**
- `--sample-config FILE`: åˆ›å»ºç¤ºä¾‹é…ç½®æ–‡ä»¶

## å¼€å‘

### æ·»åŠ æ–°çš„TTSå®¢æˆ·ç«¯

1. åœ¨ `scripts/` ç›®å½•åˆ›å»ºæ–°çš„å¯æ‰§è¡Œè„šæœ¬
2. éµå¾ªç±»ä¼¼ `chartts` çš„æ¥å£è®¾è®¡
3. è¿è¡Œ `./install.sh` å®‰è£…

### é¡¹ç›®ç»“æ„

```
tts-benchmarks/
â”œâ”€â”€ install.sh          # å®‰è£…è„šæœ¬
â”œâ”€â”€ requirements.txt    # Pythonä¾èµ–
â”œâ”€â”€ README.md          # æœ¬æ–‡æ¡£
â””â”€â”€ scripts/
    â”œâ”€â”€ chartts        # ChatTTSå‘½ä»¤è¡Œå®¢æˆ·ç«¯
    â””â”€â”€ perftest       # æ€§èƒ½æµ‹è¯•å·¥å…·
```

## ä¾èµ–

- Python 3.8+
- PyTorch 2.0+
- ChatTTS
- torchaudio

è¯¦è§ `requirements.txt`

## è®¸å¯è¯

[æ·»åŠ è®¸å¯è¯ä¿¡æ¯]

## è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

## æ•…éšœæ’é™¤

### ChatTTS æ¨¡å‹ä¸‹è½½é—®é¢˜

é¦–æ¬¡ä½¿ç”¨æ—¶ï¼ŒChatTTS ä¼šè‡ªåŠ¨ä¸‹è½½æ¨¡å‹ã€‚å¦‚æœç½‘ç»œä¸ä½³ï¼Œå¯ä»¥ï¼š

1. ä½¿ç”¨ä»£ç†
2. æ‰‹åŠ¨ä¸‹è½½æ¨¡å‹åˆ°æŒ‡å®šç›®å½•
3. ä½¿ç”¨å›½å†…é•œåƒæº

### è®¾å¤‡ä¸æ”¯æŒé—®é¢˜

å¦‚æœé‡åˆ°CUDAæˆ–MPSä¸å¯ç”¨çš„é”™è¯¯ï¼Œä½¿ç”¨ `--device cpu` å¼ºåˆ¶ä½¿ç”¨CPUï¼š

```bash
chartts -t "æµ‹è¯•" -o test.wav --device cpu
```

### å†…å­˜ä¸è¶³

å¯¹äºå¤§æ®µæ–‡æœ¬ï¼Œå¯ä»¥ï¼š

1. åˆ†æ®µå¤„ç†
2. ä½¿ç”¨æ›´å°çš„batch size
3. ä½¿ç”¨CPUè€ŒéGPU

## ç›¸å…³é“¾æ¥

- [ChatTTS GitHub](https://github.com/2noise/ChatTTS)
- [PyTorch](https://pytorch.org/)

